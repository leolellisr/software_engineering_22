<!DOCTYPE html>
<html>

<head>
  <title>Pesquisa de Passagem</title>
  <meta charset="UTF-8">
  <meta name="author" content="Gustavo de Souza dos Reis">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
</head>
<style type="text/css">
  .tg  {border-collapse:collapse;border-spacing:0;}
  .tg td{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
    overflow:hidden;padding:10px 5px;word-break:normal;}
  .tg th{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
    font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}
  .tg .tg-baqh{text-align:center;vertical-align:top}
  .tg .tg-ahzk{background-color:#6665cd;color:#f8ff00;text-align:center;vertical-align:top}
</style>
<body>

<h1>Pesquisa de Passagens</h1>

<br>

<div id="app">
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.js"></script>

  <form @submit.prevent="clear">

    <div>

      <label for="forigem">Origem:</label>
      <input type="text" id="forigem" class="form-control" v-model="recursoOrigem" size=10>
      <br>
      <label for="fdestino">Destino:</label>
      <input type="text" id="forigem" class="form-control" v-model="recursoOrigem" size=10>
      <br>
      <label for="fdata">Data:</label>
      <input type="text" id="fdata" class="form-control" v-model="recursoData" size=5>

      <br><br>

      <button type="button" class="btn btn-outline-primary" v-on:click="doGet()">Pesquisar</button>

    </div>
    <hr>
    <h2>Resultado</h2>
    <table class="table">
      <thead v-if="viagens.length > 0">
        <tr>
          <th scope="col">Origem</th>
          <th scope="col">Destino</th>
          <th scope="col">Horario Partida</th>
          <th scope="col">Data Partida</th>
          <th scope="col">Horario Chegada</th>
          <th scope="col">Data Chegada</th>
        </tr>
      </thead>
      <tbody v-if="viagens.length > 0">
        <tr v-for="v in viagens">
          <td class="tg-baqh">{{v.origem}}</td>
          <td class="tg-baqh">{{v.destino}}</td>
          <td class="tg-baqh">{{v.horarioPartida}}</td>
          <td class="tg-baqh">{{v.dataPartida}}</td>
          <td class="tg-baqh">{{v.horarioChegada}}</td>
          <td class="tg-baqh">{{v.dataChegada}}</td>
        </tr>

      </tbody>
    </table>
  </form>    
    
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.15.2/axios.js"></script>
<script>
  var app = new Vue({
    el: '#app',
    data: { 
         payload: '',
         codigo: '',
         recursoOrigem: '',
         recursoDestino: '',
         recursoData: '',
         recurso: '/viagens/' + app.recursoOrigem + "/" + app.recursoDestino,
         viagens: '',
         origem: '',
         destino: '',
         horarioPartida: '',
         horarioChegada: '',
         dataPartida: '',
         dataChegada: ''
    },
    methods: {
    
    // GET
    doGet: async function () {
       app.doClear();
       var url = app.recurso;
       if (app.recursoData.length >0){
         url = "/viagens/" + app.recursoOrigem + "/" + app.recursoDestino + "/"; + app.recursoData
       }
       var data = app.repr;
       var request = axios({"method": "get","url": url});
       try {
         response = await request
       } catch (error) {
         response = {"data": { "resultado": " URL inv√°lida" }, "status": 404, "statusText": "Error"}
       }
       app.viagens = response.data.viagens;
       
       app.payload = response.data;
       app.codigo = response.status + " "+ response.statusText;
    },
    // CLEAR
    doClear: async function() {
      app.alunos = [];
      app.ra = '';
      app.curso = '';
      app.nome = '';
      app.codigo = "";
      app.payload = "";
      }
    }
   }
  
  )
  </script> 
</body>
</html>

